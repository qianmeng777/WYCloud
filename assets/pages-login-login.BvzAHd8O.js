import{a,h as e,w as t,f as l,i as s,E as n,r as c,d as u,G as o,e as r,t as d,q as i,l as v,H as p,J as m,K as _,b as y,g as f,F as g}from"./index-2NEu-Qph.js";import{h as k,l as h,q as x,i as w,j as q}from"./index.B-KAZEfe.js";import{_ as I}from"./plugin-vueexport-helper.BCo6x5W8.js";const j={__name:"Phone",setup:n=>(n,c)=>{const u=s;return a(),e(u,{class:"header"},{default:t((()=>[l("手机号登录")])),_:1})}},C={__name:"Email",setup:n=>(n,c)=>{const u=s;return a(),e(u,{class:"header"},{default:t((()=>[l("邮箱登录")])),_:1})}},D=n("user",(()=>{const a=c(null),e=c(null),t=async()=>{const t=await(l=e.value.id,k({url:"/user/detail",data:{uid:l}}));var l;a.value={...t.profile,level:t.level,listenSongs:t.listenSongs,createDays:t.createDays}};return{profile:a,account:e,getAccount:async()=>{const a=await h();e.value=a.data.account,a.data.account&&t()},getUserDetail:t}})),A=I(u({__name:"Qr",setup(n){const u=D(),y=c(""),f=c(""),g=c(""),k=c(null);let h=null;const I=async()=>{const a=await x();y.value=a.data.data.unikey;const e=await w(y.value);f.value=e.data.data.qrimg,h=setInterval((async()=>{const a=await q(y.value);console.log(a),k.value=a.data.code,800===a.data.code?(g.value="已过期，点击重新获取",clearInterval(h)):801===a.data.code||(802===a.data.code?g.value="等待确认":803===a.data.code&&(g.value="扫码成功",p("curCookie",a.data.cookie),u.getAccount(),m({title:"登录成功",icon:"success"}),clearInterval(h),setTimeout((()=>{_({url:"/pages/recommend/Recommend"})}),1e3)))}),5e3)};I(),o((()=>{clearInterval(h)}));const j=()=>{800===k.value&&(k.value=null,I())};return(n,c)=>{const u=v,o=s;return a(),e(o,{class:"qr-wrap"},{default:t((()=>[r(u,{src:f.value,mode:"widthFix"},null,8,["src"]),null!==k.value&&801!==k.value?(a(),e(o,{key:0,class:"qr-code",onClick:j},{default:t((()=>[l(d(g.value),1)])),_:1})):i("",!0)])),_:1})}}}),[["__scopeId","data-v-ae381288"]]),E=I({__name:"login",setup(n){const u=c("phone"),o=[{type:"phone",text:"手机号登录"},{type:"email",text:"邮箱登录"},{type:"qr",text:"二维码登录"}];return(n,c)=>{const i=s;return a(),e(i,{class:"login"},{default:t((()=>[r(i,{class:"pic"}),"phone"===u.value?(a(),e(j,{key:0})):"email"===u.value?(a(),e(C,{key:1})):(a(),e(A,{key:2})),r(i,{class:"change-type"},{default:t((()=>[(a(),y(g,null,f(o,(a=>r(i,{key:a.type,class:"link",onClick:e=>u.value=a.type},{default:t((()=>[l(d(a.text),1)])),_:2},1032,["onClick"]))),64))])),_:1})])),_:1})}}},[["__scopeId","data-v-82d4191c"]]);export{E as default};
